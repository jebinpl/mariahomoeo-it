<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IT Assets</title>

<style>
body{margin:0;font-family:Arial,sans-serif}
.hidden{display:none}
button{cursor:pointer}

/* LOGIN */
#loginPage{
  max-width:320px;
  margin:150px auto;
  padding:20px;
  border:1px solid #ccc;
  text-align:center;
}
#loginPage input{
  width:100%;
  padding:8px;
  margin:6px 0;
}

/* HEADER */
.top-header{
  background:#9aa7a7;
  color:white;
  display:flex;
  align-items:center;
  padding:20px;
}
.logo-left{height:80px;margin-right:20px}
.header-text{flex:1;text-align:center}
.header-text h1{font-size:52px;margin:0;letter-spacing:4px}
.header-text p{margin:5px 0;font-size:18px}
.header-text h2{margin-top:8px;font-size:30px}

/* NAV */
.nav-bar{
  background:#20f0e0;
  padding:10px;
  display:flex;
  align-items:center;
}
.nav-link{
  margin:0 18px;
  font-size:18px;
  cursor:pointer;
}
.logout{
  margin-left:auto;
  margin-right:20px;
  font-weight:bold;
  cursor:pointer;
}

/* CONTENT */
#content{padding:20px}

/* FORM */
form{
  background:#f9f9f9;
  padding:15px;
  margin:10px 0;
}
input{padding:6px;width:100%;margin:4px 0}

/* TABLE */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #ccc;
  padding:6px;
  text-align:center;
}
th{background:#eee}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage">
  <h2>Login</h2>
  <input id="username" placeholder="Username">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">

  <div class="top-header">
    <img src="logo.png" class="logo-left">
    <div class="header-text">
      <h1>MARIA</h1>
      <p>Homoeopathic Medical College & Hospital</p>
      <h2>IT Assets</h2>
    </div>
  </div>

  <div class="nav-bar">
    <span class="nav-link" onclick="showCPU()">CPU</span>
    <span class="nav-link">Projector</span>
    <span class="nav-link">Monitor</span>
    <span class="nav-link">Printer</span>
    <span class="nav-link">TV</span>
    <span class="nav-link">DVR</span>
    <span class="nav-link">Accessories</span>
    <span class="logout" onclick="logout()">Logout</span>
  </div>

  <div id="content">
    <p id="welcomeText">Select a module from above.</p>

    <!-- CPU MODULE -->
    <div id="cpuModule" class="hidden">
      <h2>CPU Inventory</h2>

      <button onclick="openForm()">‚ûï Add CPU</button>
<button onclick="exportCPUExcel()">üìä Export CPU Excel</button>
      <form id="cpuForm" class="hidden">
        <input id="brand" placeholder="Brand" required>
        <input id="serial" placeholder="Serial Number" required>
        <input id="mac" placeholder="MAC ID" required>
        <input id="asset" placeholder="Asset ID" required>
        <input id="processor" placeholder="Processor" required>
        <input id="ram" placeholder="RAM" required>
        <input id="hdd" placeholder="HDD" required>
        <input id="dept" placeholder="DEPARTMENT" required>

        <button type="submit">Save</button>
        <button type="button" onclick="closeForm()">Cancel</button>
      </form>

      <table>
        <thead>
          <tr>
            <th>Brand</th>
            <th>Serial</th>
            <th>MAC ID</th>
            <th>Asset ID</th>
            <th>Processor</th>
            <th>RAM</th>
            <th>HDD</th>
            <th>DEPARTMENT</th>
            <th>Date Created</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="cpuTable"></tbody>
      </table>
    </div>

  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
<script>
   const firebaseConfig = {
    apiKey: "AIzaSyA1ymv16-dU8psCO-pIY0waY-Gkz3Mix9Q",
    authDomain: "mariahomoeo-it.firebaseapp.com",
    projectId: "mariahomoeo-it",
    storageBucket: "mariahomoeo-it.appspot.com",
    messagingSenderId: "926576264951",
    appId: "1:926576264951:web:fa8db2664622fb31ec75f2"
  };

  // ‚úÖ CORRECT for compat
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();


/* LOGIN */
const USER="admin", PASS="admin123";

function login(){
  if(username.value===USER && password.value===PASS){
    loginPage.classList.add("hidden");
    dashboard.classList.remove("hidden");
  }else{
    alert("‚ùå Invalid username or password");
    password.value="";
  }
}
function logout(){location.reload();}

/* NAV */
function showCPU(){
  welcomeText.style.display="none";
  cpuModule.classList.remove("hidden");
}

/* CPU LOGIC + STORAGE */
let data = [];

// REAL-TIME GLOBAL LISTENER
db.collection("cpu")
  .orderBy("createdAt", "desc")
  .onSnapshot(snapshot => {
    data = snapshot.docs.map(doc => ({
      id: doc.id,
      ...doc.data()
    }));
    render();
  });


function openForm(){
  cpuForm.classList.remove("hidden");
}
function closeForm(){
  cpuForm.classList.add("hidden");
  cpuForm.reset();
}

// Default add CPU function
function addCPU(e){
  e.preventDefault();

 function addCPU(e){
  e.preventDefault();

  db.collection("cpu").add({
    brand: brand.value,
    serial: serial.value,
    mac: mac.value,
    asset: asset.value,
    processor: processor.value,
    ram: ram.value,
    hdd: hdd.value,
    dept: dept.value,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  });

  closeForm();
}

}

cpuForm.onsubmit = addCPU;

// Render table
function render(){
  cpuTable.innerHTML="";
  data.forEach((d, index) => {
    cpuTable.innerHTML+=`
      <tr>
        <td>${d.brand}</td>
        <td>${d.serial}</td>
        <td>${d.mac}</td>
        <td>${d.asset}</td>
        <td>${d.processor}</td>
        <td>${d.ram}</td>
        <td>${d.hdd}</td>
        <td>${d.dept}</td>
        <td>${d.date}</td>
        <td>
          <button onclick="editCPU(${index})">‚úèÔ∏è Edit</button>
          <button onclick="deleteCPU(${index})">üóëÔ∏è Delete</button>
        </td>
      </tr>`;
  });
}

// Delete function
function deleteCPU(index){
  if(confirm("Are you sure you want to delete this CPU?")){
    data.splice(index, 1);
    localStorage.setItem("cpuData", JSON.stringify(data));
    render();
  }
}

// Edit function
function editCPU(index){
  const cpu = data[index];

  // Open form
  openForm();

  // Fill form with existing data
  brand.value = cpu.brand;
  serial.value = cpu.serial;
  mac.value = cpu.mac;
  asset.value = cpu.asset;
  processor.value = cpu.processor;
  ram.value = cpu.ram;
  hdd.value = cpu.hdd;
  dept.value = cpu.dept;

  // Temporarily override submit for editing
  cpuForm.onsubmit = function(e){
    e.preventDefault();

    data[index] = {
      brand: brand.value,
      serial: serial.value,
      mac: mac.value,
      asset: asset.value,
      processor: processor.value,
      ram: ram.value,
      hdd: hdd.value,
      dept: dept.value,
      date: new Date().toLocaleString()
    };

    localStorage.setItem("cpuData", JSON.stringify(data));
    render();
    closeForm();

    // Restore default addCPU behavior
    cpuForm.onsubmit = addCPU;
  };
}
  function exportCPUExcel(){
  if(data.length === 0){
    alert("No CPU data to export!");
    return;
  }

  let excelData = [];
  excelData.push([
    "Brand",
    "Serial",
    "MAC ID",
    "Asset ID",
    "Processor",
    "RAM",
    "HDD",
    "Department",
    "Date Created"
  ]);

  data.forEach(d => {
    excelData.push([
      d.brand,
      d.serial,
      d.mac,
      d.asset,
      d.processor,
      d.ram,
      d.hdd,
      d.dept,
      d.date
    ]);
  });

  let wb = XLSX.utils.book_new();
  let ws = XLSX.utils.aoa_to_sheet(excelData);
  XLSX.utils.book_append_sheet(wb, ws, "CPU Inventory");
  XLSX.writeFile(wb, "CPU_Inventory_Report.xlsx");
}
</script>

</body>
</html>






